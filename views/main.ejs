<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/x-icon" href="/resources/img/favicon.ico">
    <link rel="stylesheet" href="/resources/css/magnific-popup.css">
    <link rel="stylesheet" href="/resources/css/lose.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script type="text/javascript" src="/resources/js/gifffer.min.js"></script>
    <script src="/resources/js/topbar.js"></script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escull la teva aventura | La cova dels dies</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel='stylesheet' href='/resources/css/bafarada.css'>
    <link rel='stylesheet' href='/resources/css/fallo.css'>
    <link rel='stylesheet' href="/resources/css/seguent.css">
    <link rel='stylesheet' href="/resources/css/animate.css">
    <link rel='stylesheet' href="/resources/css/topbar.css">
    <script src="resources/js/onLoad.js"></script>
    <script src="/resources/js/jquery.magnific-popup.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1"><link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css'>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>    
    <link rel="stylesheet" type="text/css" href="/resources/css/loading-bar.css"/>
    <script type="text/javascript" src="/resources/js/loading-bar.js"></script>
    <link rel="stylesheet" href="/resources/css/buttons.css">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href='http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  </head>
<script>
    $(function(){
    var str = '#len'; 
    $(document).ready(function(){
      var i, stop;
      i = 1;
      stop = 4;
      setInterval(function(){
        if (i > stop){
          return;
        }
        $('#len'+(i++)).toggleClass('bounce');
      }, 500)
    });
  });
</script>
<style>
    .hoverable {
    display: inline-block;
    backface-visibility: hidden;
    vertical-align: middle;
    position: relative;
    box-shadow: 0 0 1px rgba(0, 0, 0, 0);
   /* tranform: translateZ(0);*/
    transition-duration: 0.3s;
    transition-property: transform;
  }
  
  .hoverable:before {
    position: absolute;
    pointer-events: none;
    z-index: -1;
    content: "";
    top: 100%;
    left: 5%;
    height: 10px;
    width: 90%;
    opacity: 0;
    background: -webkit-radial-gradient(center, ellipse, rgba(255, 255, 255, 0.35) 0%, rgba(255, 255, 255, 0) 80%);
    background: radial-gradient(ellipse at center, rgba(255, 255, 255, 0.35) 0%, rgba(255, 255, 255, 0) 80%);
    /* W3C */
    transition-duration: 0.3s;
    transition-property: transform, opacity;
  }
  
  .hoverable:hover, .hoverable:active, .hoverable:focus {
    transform: translateY(-5px);
  }
  
  .hoverable:hover:before, .hoverable:active:before, .hoverable:focus:before {
    opacity: 1;
    transform: translateY(-5px);
  }
  
  @keyframes bounce-animation {
    16.65% {
      -webkit-transform: translateY(8px);
      transform: translateY(8px);
    }
    33.3% {
      -webkit-transform: translateY(-6px);
      transform: translateY(-6px);
    }
    49.95% {
      -webkit-transform: translateY(4px);
      transform: translateY(4px);
    }
    66.6% {
      -webkit-transform: translateY(-2px);
      transform: translateY(-2px);
    }
    83.25% {
      -webkit-transform: translateY(1px);
      transform: translateY(1px);
    }
    100% {
      -webkit-transform: translateY(0);
      transform: translateY(0);
    }
  }
  .bounce {
    animation-name: bounce-animation;
    animation-duration: 2s;
  }
  
  /*everything below here is just setting up the page, so dont worry about it */
  @media (min-width: 768px) {
    .navbar {
      text-align: center !important;
      float: none;
      display: inline-block;
    }
  }
  body {
    background-color: black;
    font-weight: 600;
    text-align: center !important;
  }
  
  nav {
    background: none !important;
    text-transform: uppercase;
  }
  /*nav li {
    margin-left: 3em;
    margin-right: 3em;
  }*/
  nav li a {
    transition: 0.5s color ease-in-out;
  }
  .blinking-cursor {
    user-select: none;
    animation: blink 1s steps(2, start) infinite;
  }
  @keyframes blink {
    to {
      visibility: hidden;
    }
  }

  .page-title {
    opacity: 0.75 !important;
  }
  #type-text{
    color:white;
    font-size: 20px;
    padding: 10px;
    margin: 5px;
    position: relative ;
    left: 10px;
    font-family: topText;
  }

  @font-face{
    font-family: topText;
    src:url(/resources/css/Quikhand.ttf)
  }
</style>
<body>
  <div class="lose" id="lose"></div>
    <div class="container-fluid">
        <nav class="navbar navbar-inverse" id="topbar_border">
          <div class="container-fluid" id="topbar">
            <ul class="nav navbar-nav">
              <li><a id="len1" class="hoverable" href="/">Inici</a></li>
              <li><a id="len2" class="hoverable" href="/joc">Jugar</a></li>
            </ul>
          </div>
        </nav>  
        <div>
            <div class="page-title">
              <span is="type-async" id="type-text"></span>
              <span class="blinking-cursor">_</span>
            </div>
          </div>
        </div>
        <a id="pop-container"></a>
        <div class="barra label-center" data-value="Iniciant..." style="width: 100%; height: 60px; position: relative;"></div>  
        <div class="content" style="opacity: 0%;">
        <div id="output">
        <div class="bafarada bafarada-left" id="bafarada"><h1>Esperant una resposta...</h1>
        </div>
        <img class="talker"data-gifffer="/resources/img/happy.gif">
        <br><br><br>
    </div>
    <input id="1" type="button" hidden/>
    <input id="2" type="button" hidden/>
    <input id="3" type="button" hidden/>
    <div class="options">
          <input id="submit1" class="submits neon-button" type="button"  onclick="submit('#1', 1)" style="display: none;"/>
          <input id="submit2" class="submits neon-button" type="button"  onclick="submit('#2', 2)" style="display: none;"/>
          <input id="submit3" class="submits neon-button" type="button"  onclick="submit('#3', 3)" style="display: none;"/>
    </div>

    </div>
    <script type="module">
      var sleep = (delay) => new Promise((resolve) => setTimeout(resolve, delay))//loading.io
      function loading(){
        var bar = new ldBar(".barra", {
     "stripe": '#f00',
     "stripe-width": 30,
     "preset": "stripe",
     "value": 0
    });
    var i = 0;
    var progress = async() => {while(i<=100){
        let timing = Math.random() * (25, 20) + 20;
        let calculate = Math.round(timing)
        if(i < calculate){
          let random = Math.random() * (150 - 100) + 100;
          await sleep(random)
          bar.set(i)
          i++
        }
        else{
          await sleep(10)
          bar.set(i)
          i++
        }
      }
      $(".barra").remove();
      $(".content").css("opacity", "100%")
      run()
  }
  precheck()
  progress()
  
      }
      loading()
  </script>
    <script>
      
        var option;
        function submit(id, num){
          val=$(id).val();
          var lvl = localStorage.getItem("lvl")
          switch(num){
            case 1:
              if(localStorage.getItem("lvl") == 1){
                localStorage.setItem("lvl1response", 1)
              }
              if(localStorage.getItem("lvl") == 2){
                localStorage.setItem("lvl2response", 1)
              }
              if(localStorage.getItem("lvl") == 3){
                localStorage.setItem("lvl3response", 1)

              }
              if(localStorage.getItem("lvl") == 4){
                localStorage.setItem("lvl4response", 1)

              }
              if(localStorage.getItem("lvl") == 5){
                localStorage.setItem("lvl5response", 1)

              }
              break

            case 2:
            if(localStorage.getItem("lvl") == 1){
                localStorage.setItem("lvl1response", 2)
              }
              if(localStorage.getItem("lvl") == 2){
                localStorage.setItem("lvl2response", 2)
              }
              if(localStorage.getItem("lvl") == 3){
                localStorage.setItem("lvl3response", 2)

              }
              if(localStorage.getItem("lvl") == 4){
                localStorage.setItem("lvl4response", 2)

              }
              if(localStorage.getItem("lvl") == 5){
                localStorage.setItem("lvl5response", 2)

              }
              break

            case 3:
            if(localStorage.getItem("lvl") == 1){
                localStorage.setItem("lvl1response", 3)
              }
              if(localStorage.getItem("lvl") == 2){
                localStorage.setItem("lvl2response", 3)
              }
              if(localStorage.getItem("lvl") == 3){
                localStorage.setItem("lvl3response", 3)

              }
              if(localStorage.getItem("lvl") == 4){
                localStorage.setItem("lvl4response", 3)

              }
              if(localStorage.getItem("lvl") == 5){
                localStorage.setItem("lvl5response", 3)

              }
              break
             
          }
          if(lvl == 1){
            var dataResponses = ""+'"'+'lvl1'+'"'+":"+localStorage.getItem("lvl1response")
          }
          else if(lvl == 2){
            var dataResponses = ""+'"'+'lvl1'+'"'+":"+localStorage.getItem("lvl1response")+',"lvl2":'+localStorage.getItem("lvl2response")
          }
          else if(lvl == 3){
            var dataResponses = ""+'"'+'lvl1'+'"'+":"+localStorage.getItem("lvl1response")+',"lvl2":'+localStorage.getItem("lvl2response")+',"lvl3":'+localStorage.getItem("lvl3response")
          }
          else if(lvl == 4){
            var dataResponses = ""+'"'+'lvl1'+'"'+":"+localStorage.getItem("lvl1response")+',"lvl2":'+localStorage.getItem("lvl2response")+',"lvl3":'+localStorage.getItem("lvl3response")+',"lvl4":'+localStorage.getItem("lvl4response")
          }
          else if(lvl == 5){
            var dataResponses = ""+'"'+'lvl1'+'"'+":"+localStorage.getItem("lvl1response")+',"lvl2":'+localStorage.getItem("lvl2response")+',"lvl3":'+localStorage.getItem("lvl3response")+',"lvl4":'+localStorage.getItem("lvl4response")+',"lvl5":'+localStorage.getItem("lvl5response")
          }
          else{
            var dataResponses = '{"wrong":"wrong"}'
          }
          var option = '{'+dataResponses+','+val+'}'
          console.log(option)
          $.post("/api",$.parseJSON(option), function(data){
              if(data.status){
                document.title = data.title              
              }
                if(data.case == "fallo"){
                  youLost()
                    setTimeout( function() {
                    gifs[0].click(); 
                  }, 200);

                    escriure(data.text, 50)
                    setTimeout( function() {
                    gifs[0].click(); 
                  }, data.time);

                  
                  localStorage.removeItem("lvl")
                  var update = `{"update":"true", "lvl": 1, "uid": "${localStorage.getItem("uid")}"}`
                  $.post("/users", $.parseJSON(update))
                  window.title = "Has perdut | Escull la teva aventura"
                }
                else{
                  setTimeout( function() {
                    gifs[0].click(); 
                  }, 200);

                  escriure(data.text, 50, true, next, data.time, data.lvl)
                  localStorage.setItem("lvl", data.lvl)
                  setTimeout( function() {
                    gifs[0].click(); //will play the first gif
                  }, data.time);

                }
            });
          }
        
          $(".submits").each(function(index, element){
            var animation = TweenMax.to(this, 0.2, {
              className: '+= superShadow',
              marginTop: '-10px',
              marginBottom: '10px',
              ease: Power1.easeIn,
              paused:true 
            });
            element.animation = animation;
          })
          $('.submits').hover(function(){
            this.animation.play()
          }, function(){
            this.animation.reverse();
          })

          $("#submit1").click(function(){
            $("#submit2").fadeOut()
            $("#submit3").fadeOut()
            document.getElementById("submit1").style.boxShadow = "inset 0 0 0.5em 0 hsl(129.4, 100%, 53.9%), 0 0 0.5em 0 hsl(61.8, 100%, 53.9%)"
          })
          $("#submit2").click(function(){
            $("#submit1").fadeOut()
            $("#submit3").fadeOut()     
            document.getElementById("submit2").style.boxShadow = "inset 0 0 0.5em 0 hsl(129.4, 100%, 53.9%), 0 0 0.5em 0 hsl(61.8, 100%, 53.9%)"
          })
          $("#submit3").click(function(){
            $("#submit1").fadeOut()
            $("#submit2").fadeOut() 
            document.getElementById("submit3").style.boxShadow = "inset 0 0 0.5em 0 hsl(129.4, 100%, 53.9%), 0 0 0.5em 0 hsl(61.8, 100%, 53.9%)"
          })

</script>
</html>